[workspace]
# å¯ç”¨å‘å¸ƒåˆ° crates.ioï¼ˆä½¿ç”¨ Trusted Publishingï¼‰
publish = true

# è‡ªåŠ¨æ›´æ–° CHANGELOG.md
changelog_update = true

# è‡ªåŠ¨è¿è¡Œ cargo update
dependencies_update = true

# åˆ›å»º GitHub release
git_release_enable = true

# åˆ›å»º git tag
git_tag_enable = true

# ä»…åœ¨åˆå¹¶ release PR æ—¶å‘å¸ƒ
release_always = false

# Release PR åˆ†æ”¯å‰ç¼€
pr_branch_prefix = "release-plz-"

# Release PR æ ‡ç­¾
pr_labels = ["release"]

# Release PR æ ‡é¢˜
pr_name = "chore: release v{{ version }}"

# Release PR å†…å®¹
pr_body = """
## ğŸ¤– æ–°ç‰ˆæœ¬å‘å¸ƒ

æœ¬ PR ç”± [release-plz](https://github.com/release-plz/release-plz) è‡ªåŠ¨ç”Ÿæˆã€‚

{% for release in releases %}
### `{{ release.package }}`
- ç‰ˆæœ¬: {{ release.previous_version }} -> {{ release.next_version }}
{%- if release.semver_check == "incompatible" %} âš ï¸ **API ç ´åæ€§å˜æ›´**
{%- elif release.semver_check == "compatible" %} âœ“ **API å…¼å®¹å˜æ›´**
{%- endif %}

{% if release.breaking_changes %}
**ç ´åæ€§å˜æ›´:**
```
{{ release.breaking_changes }}
```
{% endif %}

{% if release.changelog %}
**å˜æ›´æ—¥å¿—:**
{{ release.changelog }}
{% endif %}
{% endfor %}

---

### åˆå¹¶è¯´æ˜
1. æ£€æŸ¥ç‰ˆæœ¬å·å’Œå˜æ›´æ—¥å¿—æ˜¯å¦æ­£ç¡®
2. åˆå¹¶æ­¤ PR å°†è‡ªåŠ¨å‘å¸ƒåˆ° crates.ioã€åˆ›å»º GitHub release å’Œ git æ ‡ç­¾
3. ä½¿ç”¨ Trusted Publishingï¼Œæ— éœ€ API Token

---

æ­¤ PR ç”± [release-plz](https://github.com/release-plz/release-plz) ç”Ÿæˆã€‚
"""

# GitHub release å†…å®¹
git_release_body = """
{{ changelog }}

{% if remote.contributors %}
### è´¡çŒ®è€…
{% for contributor in remote.contributors %}
* @{{ contributor.username }}
{% endfor %}
{% endif %}

---

ğŸ“¦ **Crates.io**: æ­¤ç‰ˆæœ¬å·²å‘å¸ƒåˆ° [crates.io](https://crates.io/crates/strict-num-extended)ã€‚
"""

# ä¸»åŒ…é…ç½®
[[package]]
name = "strict-num-extended"
changelog_path = "./CHANGELOG.md"
changelog_include = ["strict-num-extended-macros"]

# å®åŒ…é…ç½®
[[package]]
name = "strict-num-extended-macros"
changelog_path = "./CHANGELOG.md"

# Changelog é…ç½®
[changelog]
protect_breaking_commits = true

header = """
# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]
"""

body = """
## [{{ version }}]{%- if release_link -%}({{ release_link }}){% endif %} - {{ timestamp | date(format="%Y-%m-%d") }}
{% for group, commits in commits | group_by(attribute="group") %}
### {{ group | upper_first }}
{% for commit in commits %}
{%- if commit.scope -%}
- **({{commit.scope}})** {% if commit.breaking %}[**breaking**] {% endif %}{{ commit.message }}
{%- else -%}
- {% if commit.breaking %}[**breaking**] {% endif %}{{ commit.message }}
{%- endif %}
{%- if commit.links %} ({% for link in commit.links %}{{ link.text }}{% endfor -%}){% endif %}
{% endfor %}
{% endfor %}
"""

commit_parsers = [
    { message = "^feat", group = "æ–°å¢" },
    { message = "^fix", group = "ä¿®å¤" },
    { message = "^perf", group = "æ€§èƒ½ä¼˜åŒ–" },
    { message = "^refactor", group = "é‡æ„" },
    { message = "^docs", group = "æ–‡æ¡£" },
    { message = "^style", group = "æ ·å¼" },
    { message = "^test", group = "æµ‹è¯•" },
    { message = "^chore\\(release\\)", skip = true },
    { message = "^chore", group = "å…¶ä»–" },
    { message = "^.*", group = "å…¶ä»–" },
]

commit_preprocessors = [
    { pattern = "\\(#([0-9]+)\\)", replace = "([#${1}](https://github.com/MiyakoMeow/strict-num-extended/pull/${1}))" },
]
